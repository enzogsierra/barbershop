const summary={id:null,name:"",date:"",time:"",services:[]};function paginationHandler(){document.querySelectorAll("button[tab-id]").forEach(e=>{e.addEventListener("click",()=>{openTab(e.getAttribute("tab-id"))})})}function openTab(e){document.querySelectorAll("div.tab[tab-id]").forEach(t=>{const n=t.getAttribute("tab-id"),s=document.querySelector(`button[tab-id="${n}"]`);n==e?(t.style.display="block",s.classList="col btn btn-primary",3==e&&showSummary()):(t.style.display="none",s.classList="col btn btn-outline-light")})}async function loadServices(){try{const e=await fetch(window.location.href+"api/services");createServices(await e.json())}catch(e){console.log(e)}}function createServices(e){const t=document.querySelector(".tab-services");e.forEach(e=>{const{id:n,text:s,price:a}=e,i=document.createElement("DIV");i.classList="service p-3 rounded",i.setAttribute("service-id",""+n),i.innerHTML=`\n            <p class="service-text my-0 fs-5">${s}</p>\n            <p class="service-price my-0 fs-4 fw-bold">$${parseInt(a)}</p>\n        `,i.onclick=function(){onServiceSelected(e,i)},t.appendChild(i)})}function onServiceSelected(e,t){const{services:n}=summary,s=t.getAttribute("service-id");n.some(e=>e.id===s)?(summary.services=n.filter(e=>e.id!==s),t.classList.remove("service-selected")):(summary.services=[...n,e],t.classList.add("service-selected"))}function dateHandler(){document.querySelector("input#date").addEventListener("input",(function(e){const t=new Date(e.target.value).getUTCDay();[0,6].includes(t)?(e.target.value="",showAlert("Fines de semanas no permitidos")):(summary.date=e.target.value,hideAlert())}))}function timeHandler(){document.querySelector("input#time").addEventListener("input",(function(e){const t=e.target.value.split(":");t[0]>=8&&t[0]<=21?(summary.time=e.target.value,hideAlert()):(e.target.value="",showAlert("Nuestro horario de atenci칩n es de 8am a 10pm"))}))}function showSummary(){const e=document.querySelector(".summary-default"),t=document.querySelector(".summary");if(Object.values(summary).includes("")||0===summary.services.length)return e.classList.remove("d-none"),void t.classList.add("d-none");e.classList.add("d-none"),t.classList.remove("d-none");const{name:n,date:s,time:a,services:i}=summary;let r=0,o="";o+='<h2 class="my-0 text-center">Resumen</h2>';const c=s.split("-"),l=new Date(c[0],c[1]-1,c[2]).toLocaleString("es-ES",{weekday:"long",day:"numeric",month:"long"});o+=`\n        <div class="my-4 p-3 d-flex flex-column gap-3 text-start rounded bg-light bg-gradient bg-opacity-25">\n            <h5 class="fs-4 mb-0 px-0 col text-info">\n                <i class="fas fa-user" title="Cliente"></i>\n                <span class="text-white">${n}</span>\n            </h5>\n            <h5 class="fs-4 mb-0 px-0 col text-info">\n                <i class="far fa-calendar" title="Fecha"></i>\n                <span class="text-white">${l}</span>\n            </h5>\n            <h5 class="fs-4 mb-0 px-0 col text-info">\n                <i class="far fa-clock" title="Hora"></i>\n                <span class="text-white">${a}</span>\n            </h5>\n        </div>\n    `,o+='\n        <div class="my-4 px-4 py-3 d-flex flex-column rounded text-start bg-light bg-gradient bg-opacity-25">\n            <div class="mb-3 p-0 d-flex justify-content-between gap-2 text-info fw-bold">\n                <p class="m-0 fs-3">Servicios</p>\n                <p class="m-0 fs-3">Precio</p>\n            </div>\n    ',i.forEach(e=>{r+=parseFloat(e.price),o+=`\n            <div class="m-0 px-1 py-1 d-flex justify-content-between gap-3 border-top">\n                <p class="m-0 fs-5 fw-light">${e.text}</p>\n                <p class="m-0 fs-5 fw-light">&dollar;${parseInt(e.price)}</p>\n            </div>\n        `}),o+=`\n            <div class="pt-2 pe-1 d-flex justify-content-end gap-4 border-top fw-bold">\n                <p class="m-0 fs-4 text-info">Total</p>\n                <p class="m-0 fs-4">&dollar;${parseInt(r)}</p>\n            </div>\n\n            <div class="w-auto text-end">\n                <button class="btn btn-primary mt-3" id="summary-book-btn">Reservar</button>\n            </div>\n        </div>\n    `,t.innerHTML=o;t.querySelector("#summary-book-btn").onclick=bookDate}async function bookDate(){const{date:e,time:t,services:n}=summary,s=new FormData;s.append("date",e),s.append("time",t),s.append("services",n.map(e=>e.id));try{const e=await fetch(window.location.href+"api/book-date",{method:"POST",body:s});(await e.json()).success&&Swal.fire({icon:"success",title:"Reservado!",text:"Tu cita se reserv칩 correctamente.",confirmButtonText:"Aceptar"}).then(()=>{window.location.reload()})}catch{Swal.fire({icon:"error",title:"Ocurri칩 un error",text:"Hubo un error al reservar tu cita, intenta nuevamente m치s tarde"})}}document.addEventListener("DOMContentLoaded",(function(){openTab(1),summary.id=document.querySelector("input#date-id").value,summary.name=document.querySelector("input#date-name").value,paginationHandler(),loadServices(),dateHandler(),timeHandler()}));let alertTimeout=0;function showAlert(e){alertTimeout&&hideAlert();const t=document.querySelector(".form-alert");t.classList.remove("d-none"),t.innerHTML=`\n        <p class="my-0">\n            <strong>&CenterDot;</strong> ${e}\n        </p>\n    `,alertTimeout=setTimeout((function(){hideAlert()}),5e3)}function hideAlert(){const e=document.querySelector(".form-alert");e.classList.add("d-none"),e.innerHTML="",clearTimeout(alertTimeout),alertTimeout=0}
//# sourceMappingURL=bundle.js.map
